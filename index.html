<!--
  RSS Aggregator for Tiziana

  This simple HTML page fetches multiple RSS feeds and displays the latest
  articles for each category. It uses the free rss2json API to convert RSS
  data into JSON, then renders the top items on the page. You can modify
  the `feeds` array in the script below to add or remove sources.

  Note: The rss2json service limits requests without an API key. For
  production use, sign up for a free key at https://rss2json.com/docs and
  append `&api_key=YOUR_KEY` to the request URL.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tiziana's RSS Aggregator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
      color: #333;
    }
    header {
      background-color: #0a3d62;
      color: #fff;
      padding: 1rem 2rem;
    }
    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }
    main {
      padding: 1rem 2rem;
    }
    section {
      margin-bottom: 2rem;
    }
    section h2 {
      border-bottom: 2px solid #0a3d62;
      padding-bottom: 0.5rem;
      margin-top: 0;
    }
    .items {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .items li {
      margin-bottom: 0.75rem;
    }
    .items li a {
      text-decoration: none;
      color: #1a0dab;
    }
    .items li a:hover {
      text-decoration: underline;
    }
    .error {
      color: #b00020;
      font-style: italic;
    }
    /* Static prompts styling */
    .prompts ul {
      list-style: disc;
      padding-left: 1.5rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Tiziana's RSS Aggregator</h1>
  </header>
  <main>
    <!-- Sections will be populated by the script -->
  </main>
  <script>
    // Define the feeds to fetch. Each object has a category label and a URL.
    const feeds = [
      { category: 'Technology', url: 'https://techcrunch.com/feed/' },
      // Removed Apple feed because the Apple Newsroom RSS feed blocks CORS via allorigins
      // { category: 'Apple', url: 'https://www.apple.com/newsroom/rss-feed.rss' },
      { category: 'OpenAI', url: 'https://openai.com/blog/rss.xml' },
      { category: 'Gemini (Google AI)', url: 'https://blog.google/technology/ai/rss' },
      { category: 'iOS Shortcuts', url: 'https://www.macstories.net/tag/shortcuts/feed/' },
      // Removed Google Workspace Updates feed; the source blocks our proxy and fails to load reliably
      // { category: 'Google Workspace Updates', url: 'https://workspaceupdates.googleblog.com/feeds/posts/default' },
      { category: 'AI Business', url: 'https://venturebeat.com/feed' },
      { category: 'Hotel News', url: 'https://www.hotelmanagement.net/rss.xml' },
      { category: 'Hotel Tech (Shiji)', url: 'https://insights.shijigroup.com/feed/' },
      { category: 'Leadership', url: 'https://www.fastcompany.com/section/leadership/rss' },
      { category: 'German News', url: 'https://www.tagesschau.de/infoservices/alle-meldungen-100~rss2.xml' },
      { category: 'Travel', url: 'https://www.theguardian.com/uk/travel/rss' },
      { category: 'US News', url: 'https://feeds.npr.org/1001/rss.xml' },
      { category: 'ADHD', url: 'https://www.additudemag.com/feed/' },
      { category: 'Music', url: 'https://feeds.npr.org/1039/rss.xml' },
      { category: 'Depeche Mode', url: 'https://depeche-mode.com/feed' }
    ];

    /**
     * Create a section for each feed and initiate a fetch for its content.
     */
    function init() {
      const main = document.querySelector('main');
      feeds.forEach(feed => {
        // Create section elements
        const section = document.createElement('section');
        const header = document.createElement('h2');
        header.textContent = feed.category;
        const list = document.createElement('ul');
        list.className = 'items';
        section.appendChild(header);
        section.appendChild(list);
        main.appendChild(section);
        // Fetch feed data
        fetchFeed(feed.url, list);
      });
      // Add static ChatGPT prompts section
      addPromptsSection(main);
    }

    /**
     * Fetch a single RSS feed via rss2json and populate the list with items.
     * @param {string} feedUrl - The RSS feed URL
     * @param {HTMLElement} listEl - The UL element to populate with items
     */
    function fetchFeed(feedUrl, listEl) {
      // Fetch the RSS/Atom feed via allorigins. If no <item> elements are found,
      // attempt to fall back to <entry> elements (Atom). This improves support
      // for feeds like OpenAI and Google AI that use Atom rather than RSS.
      const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(feedUrl)}`;
      fetch(proxyUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.text();
        })
        .then(xmlText => {
          const parser = new DOMParser();
          const xml = parser.parseFromString(xmlText, 'application/xml');
          // Try RSS <item> nodes first
          let items = Array.from(xml.querySelectorAll('item'));
          // If no items, try Atom <entry> nodes
          if (items.length === 0) {
            items = Array.from(xml.querySelectorAll('entry'));
          }
          if (items.length === 0) {
            throw new Error('No entries found');
          }
          items.slice(0, 5).forEach(item => {
            const titleEl = item.querySelector('title');
            const linkEl = item.querySelector('link');
            let link;
            if (linkEl) {
              // Atom uses href attribute on <link>; RSS uses text content
              link = linkEl.getAttribute('href') || linkEl.textContent;
            } else {
              link = '#';
            }
            const title = titleEl ? titleEl.textContent.trim() : 'Untitled';
            const li = document.createElement('li');
            const a = document.createElement('a');
            a.href = link;
            a.target = '_blank';
            a.rel = 'noopener';
            a.textContent = title;
            li.appendChild(a);
            listEl.appendChild(li);
          });
        })
        .catch(error => {
          const errorLi = document.createElement('li');
          errorLi.className = 'error';
          errorLi.textContent = 'Unable to load feed.';
          listEl.appendChild(errorLi);
          console.error('Error fetching feed:', feedUrl, error);
        });
    }

    /**
     * Add a static section with curated ChatGPT prompts.
     * @param {HTMLElement} container - The parent element to append the section
     */
    function addPromptsSection(container) {
      const section = document.createElement('section');
      section.className = 'prompts';
      const header = document.createElement('h2');
      header.textContent = 'Exceptional ChatGPT Prompts';
      const p = document.createElement('p');
      p.textContent = 'Here are a few thoughtfully crafted prompts to spark creative and insightful conversations with ChatGPT:';
      const ul = document.createElement('ul');
      const prompts = [
        'Summarize a recent scientific research paper on artificial intelligence into three concise bullet points.',
        'Draft a polite and persuasive email to a client explaining the benefits of a new software upgrade.',
        'Plan a three-day itinerary in Rome that balances historical sites, local cuisine, and relaxation.'
      ];
      prompts.forEach(prompt => {
        const li = document.createElement('li');
        li.textContent = prompt;
        ul.appendChild(li);
      });
      section.appendChild(header);
      section.appendChild(p);
      section.appendChild(ul);
      container.appendChild(section);
    }

    // Initialize on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>